"""
squash -
    Module containing functions to create setup with the squash deformer
"""
import maya
maya.utils.loadStringResourcesForModule(__name__)


import maya.cmds

import maya.internal.common.cmd.deformer as cmddeformer
import maya.internal.common.utils.ui as ui_utils

# ------------------------------------------------------------------------------
# Command
# ------------------------------------------------------------------------------
class Command(cmddeformer.Command):

    def __init__(self):
        super(Command, self).__init__()

        self.commandName = 'Squash'
        self.commandHelpTag	= 'Squash'
        self.commandDescription = maya.stringTable['y_maya_internal_nodes_squash_cmd_create.kSquashCommandDescription' ]
        self.commandTitle = maya.stringTable['y_maya_internal_nodes_squash_cmd_create.kSquashCommandTitle' ]
        self.optionVarCategory = 'Deform.Squash'
        self.optionVarPrefix = 'Squash'
        self.optionVarDefaults.update( {
            'lowBound': -1.0,
            'highBound': 1.0,
            'startSmoothness': 0.0,
            'endSmoothness': 0.0,
            'maxExpandPos': 0.5,
            'expand': 1.0,
            'factor': 0.0 } )

    @classmethod
    def command(cls, **kwargs):
        '''Squash deformer
        '''
        returnedNodes = list()

        result = cmddeformer.Command.createNonLinearDeformer(deformerType='squash', **kwargs)

        if result is not None:
            deformerNode = result[0]

            settableAttrs = [ 'lowBound',
                              'highBound',
                              'startSmoothness',
                              'endSmoothness',
                              'maxExpandPos',
                              'expand',
                              'factor' ]

            cls.setNodeAttributes(deformerNode, kwargs, settableAttrs)

            returnedNodes.append(deformerNode)

        return cls.finalizeCommand(returnedNodes)

    def addBasicDeformerDialogWidgets(self):

        widgetDict = {} # {optionVarDictKey, (widgetClass, widget)}

        with ui_utils.AttributeLayoutManager():
            widget = ui_utils.floatSliderGrp(maya.stringTable['y_maya_internal_nodes_squash_cmd_create.kSquashLabelLowBound' ], -10, 0.0, llim=False)
            widgetDict['lowBound'] = (maya.cmds.floatSliderGrp, widget)

            widget = ui_utils.floatSliderGrp(maya.stringTable['y_maya_internal_nodes_squash_cmd_create.kSquashLabelHighBound' ], 0.0, 10.0, ulim=False)
            widgetDict['highBound'] = (maya.cmds.floatSliderGrp, widget)

            widget = ui_utils.floatSliderGrp(maya.stringTable['y_maya_internal_nodes_squash_cmd_create.kSquashLabelStartSmoothness' ], 0.0, 1.0, step=.01)
            widgetDict['startSmoothness'] = (maya.cmds.floatSliderGrp, widget)

            widget = ui_utils.floatSliderGrp(maya.stringTable['y_maya_internal_nodes_squash_cmd_create.kSquashLabelEndSmoothness' ], 0.0, 0.1, step=.01)
            widgetDict['endSmoothness'] = (maya.cmds.floatSliderGrp, widget)

            widget = ui_utils.floatSliderGrp(maya.stringTable['y_maya_internal_nodes_squash_cmd_create.kSquashLabelMaxExpandPos' ], 0.01, 0.99, step=.01)
            widgetDict['maxExpandPos'] = (maya.cmds.floatSliderGrp, widget)

            widget = ui_utils.floatSliderGrp(maya.stringTable['y_maya_internal_nodes_squash_cmd_create.kSquashLabelExpand' ], 0.0, 1.7, llim=False, step=.01)
            widgetDict['expand'] = (maya.cmds.floatSliderGrp, widget)

            widget = ui_utils.floatSliderGrpNoLimit(maya.stringTable['y_maya_internal_nodes_squash_cmd_create.kSquashLabelFactor' ], -10.0, 10.01)
            widgetDict['factor'] = (maya.cmds.floatSliderGrp, widget)

        return widgetDict

# ===========================================================================
# Copyright 2022 Autodesk, Inc. All rights reserved.
#
# Use of this software is subject to the terms of the Autodesk license
# agreement provided at the time of installation or download, or which
# otherwise accompanies this software in either electronic or hard copy form.
# ===========================================================================
