"""
ffd -
    Module containing functions to edit the ffd node
"""

import maya.cmds

import maya.internal.common.utils.transform as xfm_utils
import maya.internal.nodes.geometryfilter.node_interface as gf_ifc

# ------------------------------------------------------------------------------
class NodeInterface(gf_ifc.NodeInterface):
    _mayaNodeType =  'ffd'
    def __init__(self, nodeName):
        super(NodeInterface, self).__init__(nodeName)

    def getLattice(self):
        a = maya.cmds.listConnections(u'{0}.dlm'.format(self.editNode))
        return a[0] if a and len(a) > 0 else None

    def getBaseLattice(self):
        a = maya.cmds.listConnections(u'{0}.blm'.format(self.editNode))
        return a[0] if a and len(a) > 0 else None

    def parentLattices(self, topParent):

        if topParent is None:
            return

        lattice = self.getLattice()
        baseLattice = self.getBaseLattice()
        if lattice is None or baseLattice is None:
            return

        p1 = xfm_utils.getParent(lattice)
        p2 = xfm_utils.getParent(baseLattice)
        if p1 is not None and p2 is not None and p1 == p2:
            # common parent for both lattices
            maya.cmds.parent(p1, topParent)
        else:
            maya.cmds.parent(lattice, topParent)
            maya.cmds.parent(baseLattice, topParent)
# ===========================================================================
# Copyright 2022 Autodesk, Inc. All rights reserved.
#
# Use of this software is subject to the terms of the Autodesk license
# agreement provided at the time of installation or download, or which
# otherwise accompanies this software in either electronic or hard copy form.
# ===========================================================================
