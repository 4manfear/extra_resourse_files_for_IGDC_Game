import maya
maya.utils.loadStringResourcesForModule(__name__)

import maya.cmds as cmds
import maya.internal.nodes.weightgeometryfilter.ae_template as wgfae
import maya.internal.nodes.geometryfilter.ae_template as gfae
import maya.internal.common.utils.ui as ui_utils
from maya.internal.common.ae.template import Layout

class AETemplate(wgfae.AETemplate):
    def inputAttributesTableHiddenColumns(self):
        return [gfae.eColumn.kFal]

    @staticmethod
    def checkObeyExclusiveBind(nodename):
        exclusiveBind = cmds.getAttr("{}.exclusiveBind".format(nodename))
        cmds.editorTemplate(dimControl=[nodename, "weightThreshold", exclusiveBind == 1])
        cmds.editorTemplate(dimControl=[nodename, "autoWeightThreshold", exclusiveBind == 1])


    @staticmethod
    def checkAutoWeightThresholdValue(nodename):
        autoWeightThreshold = cmds.getAttr("{}.autoWeightThreshold".format(nodename))
        cmds.editorTemplate(dimControl=[nodename, "autoWeightThresholdValue", autoWeightThreshold == 0])
        cmds.editorTemplate(dimControl=[nodename, "weightThreshold", autoWeightThreshold == 1])
        cmds.editorTemplate(dimControl=[nodename, "maxDistance", autoWeightThreshold == 1])


    def buildUI(self, nodeName):
        with Layout(self, maya.stringTable['y_maya_internal_nodes_wrap_ae_template.kWrapAttributes' ], False):
            cmds.editorTemplate(beginNoOptimize=True)
            self.addControl("falloffMode")
            self.addControl("exclusiveBind", callback=self.checkObeyExclusiveBind)
            self.addControl("autoWeightThreshold", callback=self.checkAutoWeightThresholdValue)
            self.addControl("autoWeightThresholdValue", callback=self.checkAutoWeightThresholdValue)
            cmds.editorTemplate(endNoOptimize=True)

            ui_utils.addSeparatorLine()
            
            self.addControls(["weightThreshold", "maxDistance"])
            
        self.suppress("geomMatrix")
        self.suppress("driverPoints")
        self.suppress("basePoints")
        self.suppress("dropoff")
        self.suppress("smoothness")
        self.suppress("inflType")
        self.suppress("nurbsSamples")
        self.suppress("weightThreshold")
        self.suppress("wtDrty")
        self.suppress("baseDrt")

        super(AETemplate, self).buildUI(nodeName)
# ===========================================================================
# Copyright 2022 Autodesk, Inc. All rights reserved.
#
# Use of this software is subject to the terms of the Autodesk license
# agreement provided at the time of installation or download, or which
# otherwise accompanies this software in either electronic or hard copy form.
# ===========================================================================
