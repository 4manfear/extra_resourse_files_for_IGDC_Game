"""
General time utilities.
Contains methods to parse frame ranges, etc...
"""

#-------------------------------------------------------------------------------
def splitRangeSpecText(rangeSpec):
    # strip the by number after the ':'
    p = rangeSpec.rfind(':')
    rangeSpec, b = (rangeSpec, '1') if p < 0 else (rangeSpec[:p], rangeSpec[p+1:])

    # split the remainder start-end, beware of numbers like 1e-06
    e = rangeSpec.find('e', 1)
    d = rangeSpec.find('-', 1)
    p = d if d < e else rangeSpec.find('-', e+2)
    return (rangeSpec, rangeSpec, b) if p < 0 else (rangeSpec[:p], rangeSpec[p+1:], b)

#-------------------------------------------------------------------------------
def parseFloatRangeSpec(rangeSpec):
    '''Parse the rangeSpec text to a triple of (start, end, by), or None if it can not be parsed.'''
    range = splitRangeSpecText(rangeSpec.strip())
    try:
        st = float(range[0])
        et = float(range[1])
        bt = float(range[2])
        return (st, et, bt)
    except:
        return None

#-------------------------------------------------------------------------------
def parseIntegerRangeSpec(rangeSpec):
    '''Parse the rangeSpec text to a triple of (start, end, by), or None if it can not be parsed.'''
    range = splitRangeSpecText(rangeSpec.strip())
    try:
        st = int(range[0])
        et = int(range[1])
        bt = int(range[2])
        return (st, et, bt)
    except:
        return None

#-------------------------------------------------------------------------------
def frange(sr, er=None, br=None):
    '''A float range iterator, similar to the standard python integer range.'''
    s = 0.0 if er is None else sr
    e = sr if er is None else er
    b = 1.0 if br is None else br

    while True:
        if (b > 0 and s >= e) or (b < 0 and s <= e):
            break
        yield s
        s += b
# ===========================================================================
# Copyright 2022 Autodesk, Inc. All rights reserved.
#
# Use of this software is subject to the terms of the Autodesk license
# agreement provided at the time of installation or download, or which
# otherwise accompanies this software in either electronic or hard copy form.
# ===========================================================================
