'''
keySetOptionBox.py

This module provides utility methods for the interfaces that leverage
keySetOptionBoxCommon.mel.
'''

import maya.cmds as cmds
import maya.mel as mel
import maya.api.OpenMayaUI as omui

def keySetOptionBoxPreviewUIDeletedCallback( data ):
    ''' Callback to evaluate a MEL script (data) on UI deletion. '''
    mel.eval( data )

def keySetOptionBoxPreviewUIDeleted( ui_name, mel_callback ):
    ''' Function to install a UI deleted MEL callback for a given UI widget. '''
    omui.MUiMessage.addUiDeletedCallback(ui_name, keySetOptionBoxPreviewUIDeletedCallback, mel_callback)

def keySetOptionBoxSelectionTimeRange():
    '''
    Returns a tuple (start, end) for the minimum
    and maximum times of the selected keyframes.
    
    If no keys are selected, this method returns
    the time slider range.
    '''
    # Set default range to time slider range
    start = cmds.playbackOptions(q=True, min=True)
    end = cmds.playbackOptions(q=True, max=True)
    
    sel_keys = cmds.keyframe(q=True, sl=True)
    if sel_keys:
        sel_key_times = [float(i) for i in sel_keys]
        start = min(sel_key_times)
        end = max(sel_key_times)
    return (start, end)
    
    
# ===========================================================================
# Copyright 2022 Autodesk, Inc. All rights reserved.
#
# Use of this software is subject to the terms of the Autodesk license
# agreement provided at the time of installation or download, or which
# otherwise accompanies this software in either electronic or hard copy form.
# ===========================================================================
