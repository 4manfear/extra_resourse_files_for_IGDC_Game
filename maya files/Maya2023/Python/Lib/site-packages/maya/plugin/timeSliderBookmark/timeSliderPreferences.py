import maya
maya.utils.loadStringResourcesForModule(__name__)


from maya.app.prefs.OptionVar import OptionVar, OPTION_VAR_TYPE_BOOL
from maya.app.prefs.OptionVarManager import OptionVarManager
from maya.common.utils import Singleton
from future.utils import with_metaclass

PREF_CATEGORY = r'Time Slider'

#======================================================================
class TimeSliderVisiblePreference(with_metaclass(Singleton, OptionVar)):
    '''
    Class containing the information for the "caching playback HUD visibility" preference.
    '''
    ov_id = 'timeSliderBookmarkVisible' # optionVar name and unique preference ID

    def __init__(self):
        ''' Initialize the preference interface '''
        super( TimeSliderVisiblePreference, self ).__init__(self.ov_id, OPTION_VAR_TYPE_BOOL, True, PREF_CATEGORY)
        self.title = maya.stringTable['y_maya_plugin_timeSliderBookmark_timeSliderPreferences.kTimeSliderBookmarkVisibility' ]
        self.info  = maya.stringTable['y_maya_plugin_timeSliderBookmark_timeSliderPreferences.kTimeSliderBookmarkVisibilityTip'  ]


class TimeSliderBookmarkPreferences(with_metaclass(Singleton, object)):
    '''
    Class that initializes and aggregates all of the timeSlider Bookmark preferences,
    as well as supplying an interface for updating the preference values

    :member option_vars:     Dictionary of optionVars that implement caching preferences
                             KEY=optionVar name, VALUE=OptionVar object controlling it
    '''
    #----------------------------------------------------------------------
    def add_preference(self, option_var):
        ''' Add a new OptionVar to be managed by the preferences class '''
        OptionVarManager.manage( option_var )
        option_var.set_in_category( 'preferences', True )
        self.option_vars[option_var.name] = option_var

    #----------------------------------------------------------------------
    def __init__(self):
        ''' Create all of the OptionVar objects used to manage the preferences.  '''
        self.option_vars = {}
        self.add_preference( TimeSliderVisiblePreference() )



#======================================================================
def timeSliderBookmark_preferences_initialize():
    '''
    Initialize all of the optionVar monitoring used by the timeSliderBookmark preferences.
    This doesn't set up or read any optionVar values, it only creates the
    OptionVar classes required to manage the preferences.

    This function must be called on startup so that the management is in place
    before any commands or UI try to access them.
    '''
    # If there was already an existing singleton then no initialization is needed
    if Singleton.singleton_exists( TimeSliderBookmarkPreferences ):
        return

    # Just creating an object will create the singleton that persists independently
    # from this code. It doesn't have to be referenced here.
    TimeSliderBookmarkPreferences()

    # Ensure that the Maya state starts in agreement with the optionVar values
    OptionVarManager.set_state_from_preferences()
# ===========================================================================
# Copyright 2022 Autodesk, Inc. All rights reserved.
#
# Use of this software is subject to the terms of the Autodesk license
# agreement provided at the time of installation or download, or which
# otherwise accompanies this software in either electronic or hard copy form.
# ===========================================================================
