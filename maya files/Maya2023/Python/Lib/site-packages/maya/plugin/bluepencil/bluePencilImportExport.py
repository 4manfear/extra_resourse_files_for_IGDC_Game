#
# Bluepencil import and export
#
import maya
maya.utils.loadStringResourcesForModule(__name__)


from builtins import range
import maya.cmds as cmds
import string

from os import path as os_path, remove as os_remove

import zipfile


def writeArchive(archivePath, fileList):
	# Get root folder
	(archiveRoot,archiveExt) = os_path.splitext( archivePath )
	archiveRoot = os_path.basename(archiveRoot)

	# Create zip file
	zip = zipfile.ZipFile( archivePath, 'w', zipfile.ZIP_DEFLATED )

	# Add each file to the .zip file
	for file in fileList:
		if(os_path.isfile(file)):
			print("# archiving: ", file, archiveRoot)
			zip.write( file, os_path.join( archiveRoot, os_path.basename( file ) ) )
		else:
			msg = maya.stringTable['y_maya_plugin_bluepencil_bluePencilImportExport.kArchiveFileSkipped' ] % file
			cmds.warning( msg )
	zip.close()

def readArchive(archivePath, tempDirectory):
	with zipfile.ZipFile( archivePath, 'r') as gpzip:
		namelist = gpzip.namelist()
		from os import path as os_path
		for n in namelist:
			gpzip.extract( n, tempDirectory )
# ===========================================================================
# Copyright 2022 Autodesk, Inc. All rights reserved.
#
# Use of this software is subject to the terms of the Autodesk license
# agreement provided at the time of installation or download, or which
# otherwise accompanies this software in either electronic or hard copy form.
# ===========================================================================
