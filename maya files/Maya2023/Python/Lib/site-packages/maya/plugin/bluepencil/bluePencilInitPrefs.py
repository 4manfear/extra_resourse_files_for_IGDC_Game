from maya.app.prefs.OptionVarManager import OptionVarManager
from maya.common.utils import Singleton
from maya.plugin.bluepencil.bluePencilToolPreferences import BluePencilToolPreferences
from maya.plugin.bluepencil.bluePencilGeneralPreferences import BluePencilGeneralPreferences

def bluePencil_preferences_initialize():
    '''
    Initialize all of the optionVar monitoring used by the Blue Pencil preferences.
    This doesn't set up or read any optionVar values, it only creates the
    OptionVar classes required to manage the preferences.
    This function must be called on startup so that the management is in place
    before any commands or UI try to access them.
    '''
    
    updateState = False

    # Check each singleton preference manager class
    # If there was already an existing singleton then no initialization is needed
    if not Singleton.singleton_exists( BluePencilToolPreferences ):
        # Just creating an object will create the singleton that persists independently
        # from this code. It doesn't have to be referenced here.
        BluePencilToolPreferences()
        updateState = True

    if not Singleton.singleton_exists( BluePencilGeneralPreferences ):
        # Just creating an object will create the singleton that persists independently
        # from this code. It doesn't have to be referenced here.
        BluePencilGeneralPreferences()
        updateState = True

    if updateState:
        # Ensure that the Maya state starts in agreement with the optionVar values
        OptionVarManager.set_state_from_preferences()

def bluePencil_reset_preferences():
    BluePencilToolPreferences().revert_to_defaults()
# ===========================================================================
# Copyright 2022 Autodesk, Inc. All rights reserved.
#
# Use of this software is subject to the terms of the Autodesk license
# agreement provided at the time of installation or download, or which
# otherwise accompanies this software in either electronic or hard copy form.
# ===========================================================================
