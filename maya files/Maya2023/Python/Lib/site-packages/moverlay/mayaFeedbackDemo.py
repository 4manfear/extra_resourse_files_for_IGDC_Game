import maya.cmds as cmds
import moverlay as mo

def pressSubmit(dialog, up, feedback):
	cmds.adpWaypoint (n="InteractiveTutorial.Appreciation", p=["ThumbsUp={}".format("1" if up else "0"), "Feedback={}".format(feedback)])

#destroy the dialog box when the X button is pushed
def pressClosed(dialog):
    mo.g_overlay_manager.controller.theDialog().deleteLater()


mo.g_overlay_manager = mo.maya.overlayManager()
mo.g_overlay_manager.controller = mo.progressDialog.ProgressDialog(mo.g_overlay_manager.getMainWindow())
mo.g_overlay_manager.controller.theDialog().deleteLater()
 
#setup a new panel and assign it to a global variable
mo.g_overlay_manager.controller = mo.progressDialog.ProgressDialog(mo.g_overlay_manager.getMainWindow())
dropShadow = mo.higDropShadow.HIGDropShadow(mo.g_overlay_manager.getMainWindow(), mo.g_overlay_manager.controller)

#
#TODO: style = cmds.getAttr(\"controller.instruct_html_style\")
style = "\"color: white; font-size: 11pt; font-weight: normal; font-style: normal; font-family: Artifakt Element\"" ### TEMP

#load controller text
#TODO: cmds.setAttr('controller.text_query', 'dialogTitle', type="string")
#TODO: cmds.scriptNode('populateText', executeBefore=True)
#TODO: html_text = cmds.getAttr('controller.overlay_text')

#TEMP string
html_text = "Tutorial Complete" 

title = "<p style = "+style+" ><h3>"+html_text+"</h3></p>"

#TODO: cmds.setAttr('controller.text_query', 'dialogBody', type="string")
#TODO: cmds.scriptNode('populateText', executeBefore=True)
#TODO: html_text = cmds.getAttr('controller.overlay_text')

#TEMP String
html_text = """
Congratulations on finishing your first interactive tutorial in Maya!  In this tutorial you learned: <ul><li>Viewport Navigation</li><li>Object Transformation</li><li>Finding and Framing objects</li></ul>Was this tutorial helpful?
"""

description = "<p style="+style+" >"+html_text+"</p>"

# TODO get rest of strings from nodes

mo.g_overlay_manager.controller.setTitle(title)
mo.g_overlay_manager.controller.setBodyText(description)
mo.g_overlay_manager.controller.setThumbsUpThumbsDownButtons(True)
mo.g_overlay_manager.controller.setThumbsFeedbackText(
  "<p style="+style+" >" + 'Tell us more...' + "</p>", #TEMP strings
  "<p style="+style+" >" + 'What can we do better?' + "</p>") #TEMP strings

mo.g_overlay_manager.controller.setupSubmitFeedback('Type your comments here', 'Submit', pressSubmit)
mo.g_overlay_manager.controller.setCloseCallback(pressClosed)

mo.g_overlay_manager.controller.showAndRaise()
# ===========================================================================
# Copyright 2022 Autodesk, Inc. All rights reserved.
#
# Use of this software is subject to the terms of the Autodesk license
# agreement provided at the time of installation or download, or which
# otherwise accompanies this software in either electronic or hard copy form.
# ===========================================================================
