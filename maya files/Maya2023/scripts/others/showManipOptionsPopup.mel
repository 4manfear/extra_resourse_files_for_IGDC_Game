// ===========================================================================
// Copyright 2022 Autodesk, Inc. All rights reserved.
//
// Use of this software is subject to the terms of the Autodesk license
// agreement provided at the time of installation or download, or which
// otherwise accompanies this software in either electronic or hard copy form.
// ===========================================================================

//
// Create popup menu for the showManip tool options
//

global proc showManipOptionsPopup()
{
	// Parent menu already set when this function is called,
	// so just add a menu items
	string $nodeName = `showManipCtx -q -currentNodeName showManip3D`;
	if ("" == $nodeName)
	{
		string $sel[] = `ls -sl -dependencyNodes`;
		if (0 == `size $sel`)
		{
			$sel = `ls -sl -dagObjects -shapes`;
		}

		if (0 < `size $sel`)
		{
			string $hist[] = `listHistory -pruneDagObjects 1 $sel[0]`;
			if (0 < `size $hist`)
			{
				$nodeName = $hist[0];
			}
		}
	}

	string $optionsScript = optionsPopupFile($nodeName);
	if ("" != $optionsScript)
	{
		eval($optionsScript + " \"" + $nodeName + "\"");
	}
}
