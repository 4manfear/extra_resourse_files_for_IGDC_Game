// ===========================================================================
// Copyright 2022 Autodesk, Inc. All rights reserved.
//
// Use of this software is subject to the terms of the Autodesk license
// agreement provided at the time of installation or download, or which
// otherwise accompanies this software in either electronic or hard copy form.
// ===========================================================================
//
//
//  Creation Date:  1 April 1996
//
//
//  Description:
//      This implements the "Display" menu on the main menubar.
//

////////////////////////////////////////////////////
//
// Builds only the top level of the Display menu,
// in order to speed up startup time - note that
// the submenus of the display menu should also
// be dynamically built, as there is a large number
// of entries in the display menu that causes the
// dynamic loading to be fairly slow.
//
///////////////////////////////////////////////////

// The top level Display menu is now being built on startup.
// This is to correct problems with the subprocs that are in the file
// not being found when the items are dragged to the shelf and
// it is by request of a number of users who don't like having
// to wait for this heavily used menu.  -llm
//
{
	global string $gMainDisplayMenu;
	global string $gMainWindow;

	string $menu = `menu -p $gMainWindow -l (uiRes("m_DisplayMenu.kDisplay"))
		-tearOff true -aob 1 
		-postMenuCommandOnce true
		-familyImage "menuIconDisplay.png" $gMainDisplayMenu`;
		
	buildDisplayMenu $menu;

	// When these events are received, then call the appropriate update proc.
	//
	scriptJob -permanent -parent $gMainDisplayMenu 
		-event "gridDisplayChanged" "if (!`exists gridMenuUpdate`) {eval \"source buildDisplayMenu\";} gridMenuUpdate;";
	scriptJob -permanent -parent $gMainDisplayMenu  
		-event "axisAtOriginChanged" "if (!`exists originAxesMenuUpdate`) {eval \"source buildDisplayMenu\";} originAxesMenuUpdate;";
	scriptJob -permanent -parent $gMainDisplayMenu  
		-event "SelectionChanged" "if (!`exists polyNormalSizeMenuUpdate`) {eval \"source buildDisplayMenu\";} polyNormalSizeMenuUpdate;";
	scriptJob -permanent -parent $gMainDisplayMenu
			-event "metadataVisualStatusChanged" ("if (!`exists updateMetadataUI`) {eval \"source buildDisplayMenu\";} updateMetadataUI;");
	scriptJob -permanent -parent $gMainDisplayMenu
			-event "SceneOpened" ("if (!`exists resetMetadataUI`) {eval \"source buildDisplayMenu\";} resetMetadataUI;");
 }
